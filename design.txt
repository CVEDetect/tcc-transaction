A. business transaction flow：
TCC->TransactionManager->Transaction->TransactionRepository.crud--->TransactionStore--->TransactionStorage.crud
                                                                                   JDBCTransactionStorage-->TCC_TRANSACTION_STORE
                                                                                   RedisTransactionStorage-->HASH
                                                                                   RocksDbTransactionStorage-->KV
                                                                                   RemotingTransactionStorage-->RemotingCommand---->RemotingCommand-->TransactionStore-->TransactionStorage
                                                                                                                                                                         JDBCTransactionStorage
                                                                                                                                                                         RedisTransactionStorage
                                                                                                                                                                           RocksDbTransactionStorage
--------------------------------------------------------------------------------------------------------------------
B. transaction recovery flow：
1. check if TransactionStorage support recovery, if true then:
2. find the transactions need recovery: Recovery->TransactionRepository->findSince->TransactionStorage->TransactionStore->Transaction
3. do the recovery: Transaction.commit/rollback->TransactionRepository.crud

--------------------------------------------------------------------------------------------------------------------
C. Sever Side(only for Server Mode)
1. Business transaction process flow：RemotingCommand->TransactionStore->TransactionStorage->JDBC/Redis/RocksDb
2. Recovery flow: find the transactions need recovery:
2.1 RecoveryJob scheduled scan the TransactionStores need recovery(for long time do not updated)
2.2 for each TransactionStore,
2.2.1 if it is root transaction, obtain its xid,
2.2.2 else if it is branch transaction, then try find out its root transaction, change the branch transaction status according to the root transaction status, and then obtain its xid
2.3 callback the business applications with the xids
2.4 the business applications received the xids find out Transactons by xids
2.5 the business applications do the recovery process

D. Other
1. remove the degrade support
2. remove the branch transaction recovery by find root transaction support



-------------------------
TransactionStoreRecovery->TransactionStorage
                        ->RecoveryExecutor
-------------------------

1.
AppConfig->Storage
         ->RecoveryConfig
         ->NettyClientConfig
         ->TccClientConfig
2.
AppConfig->Storage
         ->RecoveryConfig
         ->NettyClientConfig
         ->TccServerConfig
------------------------
--------plan--------
1. Client Auto Reconnect(V)
2. Client Auto Register(V)
3. Server Auto deregister(V)
4. Server Cluster Recovery(V)
5. Server concurrent recovery(V)
6. server cluster(V)(nacos,ZK)
7. startup shell script(X)
8. server dashboard(X)
9. Config file(X)
10. nacos/zk manual offline support(X)
11. support feign rpc & add feign sample(X)

-------

https://blog.csdn.net/weixin_40910372/article/details/104800143



